<!-- immobilier-list.component.html -->
<br><br><br>
<div class="mb-3">
  <label for="priceSearch">Search by Price:</label>
  <input type="number" id="priceSearch" [(ngModel)]="searchPrice" class="form-control" (input)="filterRealties()">
</div>

<div class="card-deck">
  <ul class="list-unstyled d-flex flex-wrap">
    <li *ngFor="let realty of filteredRealties" class="col-md-4">
      <div class="card m-2">
        <div class="card-body">
          <h5 class="card-title">{{ realty.address }}</h5>
          <p class="card-text">Price: {{ realty.price }}</p>
          <p class="card-text">Bedrooms: {{ realty.bedrooms }}</p>
          <p class="card-text">Bathrooms: {{ realty.bathrooms }}</p>
          <p class="card-text">Details: {{ realty.imageUrl }}</p>
          <div class="dropdown">
            <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
              Actions
            </button>
            <ul class="dropdown-menu dropdown-menu-dark">
              <li><a class="dropdown-item active" (click)="openUpdateModal(realty)" data-bs-toggle="modal" data-bs-target="#updateModal">Update</a></li>
              <li><a class="dropdown-item" (click)="deleteRealty(realty._id)">Delete</a></li>
            </ul>
          </div>
        </div>
      </div>
    </li>
  </ul>
</div>

<div *ngIf="realties && realties.length === 0">
  No realties found.
</div>

<div *ngIf="!realties">
  Loading...
</div>

<div *ngIf="error" class="alert alert-danger mt-3">
  Error fetching realties: {{ error }}
</div>

<div class="modal fade" id="updateModal" tabindex="-1" role="dialog" aria-labelledby="updateModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="updateModalLabel">Update Realty</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="updateForm" (ngSubmit)="onSubmit()">
          <label for="address">Address:</label>
          <input type="text" id="address" formControlName="address" class="form-control" required>

          <label for="price">Price:</label>
          <input type="number" id="price" formControlName="price" class="form-control" required>

          <label for="bedrooms">Bedrooms:</label>
          <input type="number" id="bedrooms" formControlName="bedrooms" class="form-control" required>

          <label for="bathrooms">Bathrooms:</label>
          <input type="number" id="bathrooms" formControlName="bathrooms" class="form-control" required>

          <label for="details">More details:</label>
          <textarea type="text" id="details" formControlName="details" class="form-control" required></textarea>

          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" (click)="cancelUpdate()">Close</button>
            <button type="submit" class="btn btn-primary">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
